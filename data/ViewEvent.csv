"{""ObjectName"":""ViewEvent"",""Version"":""1.0"",""TimeZone"":""GMT"",""Pattern"":""""}"
id,name,view,action,createdBy,createdDate,lastModifiedBy,lastModifiedDate,systemModifiedDate,deletedDate,isDeleted,owner,installedPackage,custom,protectMode,visibility,belongTo
string,string,string,clob,string,date,string,date,date,date,bool,string,string,bool,numeric,numeric,string
003h00000152T63lvu1Q,button_0_click,003g000001528SHQSR3w,"[{""type"":""$core.execJSCode"",""options"":{""content"":""// Current Component\r\nlet _component = context.getCurrentComponent()\r\n\r\n// Current Form\r\nlet  _form = _component.getForm()\r\n\r\n_form.formSave()\r\n""}}]",10gd00000150QfGpNugy,2023-07-19 06:56:10,10gd00000150QfGpNugy,2023-07-19 06:56:10,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h00000152T63lvu1R,button_1_click,003g000001528SHQSR3w,"[{""type"":""$core.execJSCode"",""options"":{""content"":""// Current Component\r\nlet _component = context.getCurrentComponent()\r\n\r\n// Current Form\r\nlet  _form = _component.getForm()\r\n\r\n_form.resetFields()\r\n""}}]",10gd00000150QfGpNugy,2023-07-19 06:56:10,10gd00000150QfGpNugy,2023-07-19 06:56:10,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h00000152T65CD9TU,button_16_click,003g000001528SIbyXke,"[{""type"":""$core.execJSCode"",""options"":{""content"":""// Current Component\r\nlet _component = context.getCurrentComponent()\r\n\r\n// Current Form\r\nlet  _form = _component.getForm()\r\n\r\n_form.resetFields()\r\n""}}]",10gd00000150QfGpNugy,2023-07-19 06:56:10,10gd00000150QfGpNugy,2023-07-19 06:56:10,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h00000152T65CD9TV,button_21_click,003g000001528SIbyXke,"[{""type"":""$core.execJSCode"",""options"":{""content"":""$model.ref(\""showModal\"").setData(false);\r\n// Reset\r\ncontext.$component.get(\""Detail\"").resetFields();""}}]",10gd00000150QfGpNugy,2023-07-19 06:56:10,10gd00000150QfGpNugy,2023-07-19 06:56:10,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h00000152T65CD9TW,button_22_click,003g000001528SIbyXke,"[{""type"":""$core.execJSCode"",""options"":{""content"":""context.$component.get(\""Detail\"").formValidate().then(function (valid) {\r\n    // Current Component\r\n    let table = context.$page.getComponentByName(\""Records\"");\r\n    const i18n = getI18n();\r\n    $model.ref('saveBtnLoading').setData(true);\r\n\r\n    $model.ref(\""Detail\"").save().then(data => {\r\n        // Success message\r\n        if (data.resCode == 0) {\r\n            context.$message.success(i18n.successInfo);\r\n            table.doQuery();\r\n            // Close the modal\r\n            $model.ref(\""showModal\"").setData(false);\r\n            // Reset\r\n            context.$component.get(\""Detail\"").resetFields();\r\n            setTimeout(function () {\r\n                $model.ref('saveBtnLoading').setData(false);\r\n            }, 1000);\r\n        }\r\n        else {\r\n            context.$message.error(i18n.failureInfo + data.resMsg, 5)\r\n            $model.ref('saveBtnLoading').setData(false);\r\n        }\r\n    }).catch(e => {\r\n        // Failure message\r\n        context.$message.error(i18n.failureInfo + e, 5)\r\n        $model.ref('saveBtnLoading').setData(false);\r\n    });\r\n});\r\n\r\nfunction getI18n() {\r\n    const locale = (context.$page.$page.$i18n || {}).locale || \""en_US\"";\r\n    const i18n = {\r\n        \""zh_CN\"": {\r\n            successInfo: '保存成功',\r\n            failureInfo: '保存失败：'\r\n        },\r\n        \""en_US\"": {\r\n            successInfo: 'Save Successfully',\r\n            failureInfo: 'Save Failed:'\r\n        }\r\n    };\r\n    return i18n[locale];\r\n}""}}]",10gd00000150QfGpNugy,2023-07-19 06:56:10,10gd00000150QfGpNugy,2023-07-19 06:56:10,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h00000152T65CD9TX,button_23_click,003g000001528SIbyXke,"[{""type"":""$core.execJSCode"",""options"":{""content"":""context.$component.get(\""Detail\"").formValidate().then(function (valid) {\r\n    // Current Component\r\n    let table = context.$page.getComponentByName(\""Records\"");\r\n    const i18n = getI18n();\r\n\r\n    $model.ref(\""Detail\"").save().then(data => {\r\n        // Success message\r\n        if (data.resCode == 0) {\r\n            table.doQuery();\r\n            // Close modal\r\n            $model.ref(\""showModal\"").setData(false);\r\n            // Reset\r\n            setTimeout(function () {\r\n                context.$component.get(\""Detail\"").resetFields();\r\n            });\r\n            // Submit for approval\r\n            context.$approval(data.result[0].id).then(res => {\r\n                if (res.resCode == 0) {\r\n                    context.$message.success(i18n.successInfo);\r\n                }\r\n                else if (res.resCode == \""405230808\"") {\r\n                    $model.ref(\""showUserModal\"").setData(true);\r\n                    $model.ref(\""recordId\"").setData(data.result[0].id);\r\n                }\r\n                else {\r\n                    context.$message.error(i18n.submitFail + res.resMsg, 5)\r\n                }\r\n            })\r\n        }\r\n        else {\r\n            context.$message.error(i18n.failureInfo + data.resMsg, 5)\r\n        }\r\n    }).catch(e => {\r\n        // Failure message\r\n        context.$message.error(i18n.failureInfo + e, 5)\r\n    });\r\n});\r\n\r\n\r\nfunction getI18n() {\r\n    const locale = (context.$page.$page.$i18n || {}).locale || \""en_US\"";\r\n    const i18n = {\r\n        \""zh_CN\"": {\r\n            successInfo: '保存成功',\r\n            failureInfo: '保存失败：',\r\n            submitFail: \""提交审批失败：\""\r\n        },\r\n        \""en_US\"": {\r\n            successInfo: 'Save Successfully',\r\n            failureInfo: 'Save Failed:',\r\n            submitFail: \""Submit Approval Failed:\""\r\n        }\r\n    };\r\n    return i18n[locale];\r\n}""}}]",10gd00000150QfGpNugy,2023-07-19 06:56:10,10gd00000150QfGpNugy,2023-07-19 06:56:10,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h00000152T65CD9TY,modal_1_on-ok,003g000001528SIbyXke,"[{""type"":""$core.execJSCode"",""options"":{""content"":""const i18n = getI18n();\r\n\r\ncontext.$approval($model.ref(\""recordId\"").getData(), $model.ref(\""approvalUser\"").getData()).then(res => {\r\n    if (res.resCode == 0) {\r\n        context.$message.success(i18n.successInfo);\r\n    }\r\n    else if (res.resCode == \""405230808\"") {\r\n        $model.ref(\""showUserModal\"").setData(true);\r\n    }\r\n    else {\r\n        context.$message.error(i18n.failureInfo + res.resMsg, 5)\r\n    }\r\n})\r\n\r\n\r\nfunction getI18n() {\r\n    const locale = (context.$page.$page.$i18n || {}).locale || \""en_US\"";\r\n    const i18n = {\r\n        \""zh_CN\"": {\r\n            successInfo: '保存成功',\r\n            failureInfo: '保存失败：'\r\n        },\r\n        \""en_US\"": {\r\n            successInfo: 'Save Successfully',\r\n            failureInfo: 'Save Failed:'\r\n        }\r\n    };\r\n    return i18n[locale];\r\n} ""}}]",10gd00000150QfGpNugy,2023-07-19 06:56:10,10gd00000150QfGpNugy,2023-07-19 06:56:10,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h00000152T65CD9TZ,modal_0_on-ok,003g000001528SIbyXke,"[{""type"":""$core.execJSCode"",""options"":{""content"":""// Current Component\r\nlet table = context.$page.getComponentByName(\""Records\"");\r\n\r\n// Get component by node name \r\nlet form = this.$component.get(\""Detail\"");\r\n\r\nconst i18n = getI18n();\r\n\r\n// Get the binding model of the component, call the save action to save the data\r\nform.getDataModel().save().then(data => {\r\n    // Success message\r\n    if (data.resCode == 0) {\r\n        context.$message.success(i18n.successInfo);\r\n        // Refresh table\r\n        table.doQuery();\r\n    }\r\n    else {\r\n        context.$message.error(i18n.failureInfo + data.resMsg, 5)\r\n    }\r\n}).catch(e => {\r\n    // Failure message\r\n    context.$message.error(i18n.failureInfo + e, 5)\r\n});\r\n\r\nfunction getI18n() {\r\n    const locale = (context.$page.$page.$i18n || {}).locale || \""en_US\"";\r\n    const i18n = {\r\n        \""zh_CN\"": {\r\n            successInfo: '保存成功',\r\n            failureInfo: '保存失败：'\r\n        },\r\n        \""en_US\"": {\r\n            successInfo: 'Save Successfully',\r\n            failureInfo: 'Save Failed:'\r\n        }\r\n    };\r\n    return i18n[locale];\r\n}""}}]",10gd00000150QfGpNugy,2023-07-19 06:56:10,10gd00000150QfGpNugy,2023-07-19 06:56:10,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h00000152T65CD9Ta,button_0_click,003g000001528SIbyXke,"[{""type"":""$core.execJSCode"",""options"":{""content"":""var modalTitle = {\""en_US\"":\""New\"",\""zh_CN\"":\""创建\""};\r\nvar _component = context.$component.current;\r\nvar locale = (_component._i18n  &&  _component._i18n.locale) || 'zh_CN';\r\nvar model = context.$page.getModel();\r\nmodel.modalTitle = modalTitle[locale] || modalTitle['zh_CN'];\r\n\r\n$model.ref(\""Detail\"").setData({});\r\n\r\n// Show the \""hideSaveNewBtn\"" button\r\n$model.ref(\""hideSaveNewBtn\"").setData(false);\r\n\r\n// Determine whether to display the \""hideApprovalBtn\"" button\r\ncontext.$object(\""Detail\"").then(objectMeta =>{\r\n    if(objectMeta && objectMeta.aprovalProcesses &&  objectMeta.aprovalProcesses.length > 0) {\r\n        $model.ref(\""hideApprovalBtn\"").setData(false);\r\n    }\r\n    else {\r\n        $model.ref(\""hideApprovalBtn\"").setData(true);\r\n    }\r\n    \r\n    // show modal\r\n    $model.ref(\""showModal\"").setData(true);\r\n});""},""key"":""1659940009648"",""__handlerName"":"""",""__nodeName"":""自定义JS代码""}]",10gd00000150QfGpNugy,2023-07-19 06:56:10,10gd00000150QfGpNugy,2023-07-19 06:56:10,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h00000152T65CD9Tb,button_15_click,003g000001528SIbyXke,"[{""type"":""$core.execJSCode"",""options"":{""content"":""// Current Component\r\nlet _component = context.getCurrentComponent()\r\n\r\n// Current Form\r\nlet  _form = _component.getForm()\r\n\r\n_form.formSave()\r\n""}}]",10gd00000150QfGpNugy,2023-07-19 06:56:10,10gd00000150QfGpNugy,2023-07-19 06:56:10,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h00000152T65CD9Tc,button_24_click,003g000001528SIbyXke,"[{""type"":""$core.execJSCode"",""options"":{""content"":""context.$component.get(\""Detail\"").formValidate().then(function (valid) {\r\n    // Current Component\r\n    let table = context.$page.getComponentByName(\""Records\"");\r\n    const i18n = getI18n();\r\n    $model.ref('saveNewBtnLoading').setData(true);\r\n\r\n    $model.ref(\""Detail\"").save().then(data => {\r\n        // Success message\r\n        if (data.resCode == 0) {\r\n            context.$message.success(i18n.successInfo);\r\n            table.doQuery();\r\n            // Clear data\r\n            $model.ref(\""Detail\"").setData({});\r\n            // Reset\r\n    context.$component.get(\""Detail\"").resetFields();\r\n        setTimeout(function () {\r\n                $model.ref('saveNewBtnLoading').setData(false);\r\n            }, 300);\r\n        }\r\n        else {\r\n            context.$message.error(i18n.failureInfo + data.resMsg, 5)\r\n            $model.ref('saveNewBtnLoading').setData(false);\r\n        }\r\n    }).catch(e => {\r\n        // Failure message\r\n        context.$message.error(i18n.failureInfo + e, 5)\r\n        $model.ref('saveNewBtnLoading').setData(false);\r\n    });\r\n});\r\n\r\nfunction getI18n() {\r\n    const locale = (context.$page.$page.$i18n || {}).locale || \""en_US\"";\r\n    const i18n = {\r\n        \""zh_CN\"": {\r\n            successInfo: '保存成功',\r\n            failureInfo: '保存失败：'\r\n        },\r\n        \""en_US\"": {\r\n            successInfo: 'Save Successfully',\r\n            failureInfo: 'Save Failed:'\r\n        }\r\n    };\r\n    return i18n[locale];\r\n}""}}]",10gd00000150QfGpNugy,2023-07-19 06:56:10,10gd00000150QfGpNugy,2023-07-19 06:56:10,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h00000152T65CD9Td,modal_on-cancel_1545208415426026,003g000001528SIbyXke,"[{""type"":""$core.execJSCode"",""options"":{""content"":""// Reset\r\ncontext.$component.get(\""Detail\"").resetFields();""}}]",10gd00000150QfGpNugy,2023-07-19 06:56:10,10gd00000150QfGpNugy,2023-07-19 06:56:10,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h00000152T65CD9Te,butto_click_1545274225904000,003g000001528SIbyXke,"[{""type"":""$core.execJSCode"",""options"":{""content"":""let _component = context.$component.current;\r\nvar modalTitle =  {\""en_US\"":\""Modify\"",\""zh_CN\"":\""修改\""};\r\nvar locale = (_component._i18n  &&  _component._i18n.locale) || 'zh_CN';\r\nvar model = context.$page.getModel();\r\nmodel.modalTitle = modalTitle[locale] || modalTitle['zh_CN'];\r\n\r\nlet curRow = _component.$attrs.row;\r\n\r\nlet formModel = $model.ref(\""Detail\"");\r\n\r\n$model.ref(\""hideApprovalBtn\"").setData(true);\r\n\r\n$model.ref(\""hideSaveNewBtn\"").setData(true);\r\n\r\nformModel.queryById(curRow.id).then(() => {\r\n    $model.ref(\""showModal\"").setData(true);\r\n});\r\n\r\n""},""key"":""1659939568569"",""__handlerName"":"""",""__nodeName"":""自定义JS代码"",""expand"":true}]",10gd00000150QfGpNugy,2023-07-19 06:56:10,10gd00000150QfGpNugy,2023-07-19 06:56:10,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h0000015RUXV4qA3U,butto_click_1689820663244005,003g00000153pWsKfce0,"[{""type"":""$core.execJSCode"",""options"":{""content"":""//获取当前组件（即table）\nlet _component = context.$component.current;\n//获取当前行row，取对象的id属性\nlet rowId = _component.$attrs.row.id;\n//带着id跳转到设备详情页面\ncontext.$page.load('/besBaas/page#/NPNM__editEquipment?id='+rowId);""},""key"":""1689821440184"",""__handlerName"":""javaScriptCodeHandler"",""__nodeName"":""自定义JS代码"",""expand"":true}]",10gd00000150QfGpNugy,2023-08-03 08:46:30,10gd00000150QfGpNugy,2023-08-03 08:46:30,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h0000015RUXV4qA3V,butto_click_1689820663244011,003g00000153pWsKfce0,"[{""type"":""$core.execJSCode"",""options"":{""content"":""//获取当前组件（即table）\nlet _component = context.$component.current;\n//获取当前行\nlet row = _component.$attrs.row;\n// 表格组件\nlet _table =this.$component.table;\n// 删除当前行数据\nthis.$dialog.confirm({\n    title:'确认框',\n    content:'确认是否删除？',\n    okText:\""确定\"",\n    cancelText:\""取消\"",\n    onOk:()=>{\n        $model.ref('deleteEquipment').setData({inputParam:{\""id\"": row.id}});\n        $model.ref('deleteEquipment').run().then(function(data){\n            let pageInfo = $model.ref('table_0_condition').getData().pageInfo;\n            let queryData ={\n                \""start\"":(pageInfo.curPage -1)* pageInfo.pageSize,\n                \""limit\"": pageInfo.pageSize\n            };\n        $model.ref('queryEquipments').setData({inputParam: queryData});\n        $model.ref('queryEquipments').run().then(function(data){\n            $model.ref('equipmentInstance').setData(data.equipments);\n            pageInfo.total = parseInt(data.total);\n            $model.ref('table_0_condition').setData({\""pageInfo\"": pageInfo});\n}).catch(function(error){\n                console.log('error is', error);\n});\n});\n}\n});""},""key"":""1689821570785"",""__handlerName"":""javaScriptCodeHandler"",""__nodeName"":""自定义JS代码""}]",10gd00000150QfGpNugy,2023-08-03 08:46:30,10gd00000150QfGpNugy,2023-08-03 08:46:30,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h0000015RUXV4qA3W,butto_click_1689820663244012,003g00000153pWsKfce0,"[{""type"":""$core.execJSCode"",""options"":{""content"":""//跳转到编辑设备信息页面\ncontext.$page.load('/besBaas/page#/NPNM__editEquipment');""},""key"":""1689923656652"",""__handlerName"":""javaScriptCodeHandler"",""__nodeName"":""自定义JS代码""}]",10gd00000150QfGpNugy,2023-08-03 08:46:30,10gd00000150QfGpNugy,2023-08-03 08:46:30,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h0000015RUXV4qA3X,butto_click_1689826877998009,003g00000153pWsKfce0,"[{""type"":""$core.execJSCode"",""options"":{""content"":""var pageInfo = $model.ref('table_0_condition').getData().pageInfo;\nvar queryInfo = $model.ref('table_0_condition').getData().queryInfo;\nif (!queryInfo) {\n    queryInfo = {};\n}\nvar queryData = {\n    \""fullAddress\"": queryInfo.NPNM__fullAddress__CST,\n    \""name\"": queryInfo.name,\n    \""start\"": 0, \n    \""limit\"": pageInfo.pageSize\n};\n$model.ref('queryEquipments').setData({inputParam: queryData});\n$model.ref('queryEquipments').run().then(function (data) {\n    $model.ref('equipmentInstance').setData(data.equipments);\n    pageInfo.total = parseInt(data.total);\n    $model.ref('table_0_condition').setData({\""pageInfo\"": pageInfo});\n}).catch(function (error) {\n    console.log('error is', error);\n}); ""},""key"":""1689827378051"",""__handlerName"":""javaScriptCodeHandler"",""__nodeName"":""自定义JS代码""}]",10gd00000150QfGpNugy,2023-08-03 08:46:30,10gd00000150QfGpNugy,2023-08-03 08:46:30,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h0000015RUXV4qA3Y,butto_click_1689826877998010,003g00000153pWsKfce0,"[{""key"":""16898273013341"",""__handlerName"":""formResetHandler"",""__nodeName"":""重置表单"",""type"":""$form.reset"",""options"":[{""id"":""1689826877998003"",""name"":""form_1""}]}]",10gd00000150QfGpNugy,2023-08-03 08:46:30,10gd00000150QfGpNugy,2023-08-03 08:46:30,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h0000015RUXV4qA3Z,Desig_on-load_1,003g00000153pWsKfce0,"[{""type"":""$core.execJSCode"",""options"":{""content"":""let pageInfo = $model.ref('table_0_condition').getData().pageInfo;\nlet queryData ={\n\""start\"":(pageInfo.curPage -1)* pageInfo.pageSize,\n\""limit\"": pageInfo.pageSize\n};\n$model.ref('queryEquipments').setData({ inputParam: queryData });\n$model.ref('queryEquipments').run().then(function(data){\n    $model.ref('equipmentInstance').setData(data.equipments);\n    pageInfo.total = parseInt(data.total);\n    $model.ref('table_0_condition').setData({\""pageInfo\"": pageInfo });\n}).catch(function(error){\n    console.log('error is', error);\n});""},""key"":""1689828409221"",""__handlerName"":""javaScriptCodeHandler"",""__nodeName"":""自定义JS代码"",""expand"":true}]",10gd00000150QfGpNugy,2023-08-03 08:46:30,10gd00000150QfGpNugy,2023-08-03 08:46:30,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h000001547Y9gbPwu,button_0_click,003g000001547OTtcNMm,"[{""type"":""$core.execJSCode"",""options"":{""content"":""// Current Component\r\nlet _component = context.getCurrentComponent()\r\n\r\n// Current Form\r\nlet  _form = _component.getForm()\r\n\r\n_form.formSave()\r\n""}}]",10gd00000150QfGpNugy,2023-07-20 06:49:52,10gd00000150QfGpNugy,2023-07-20 06:49:52,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h000001547Y9gbPwv,button_1_click,003g000001547OTtcNMm,"[{""type"":""$core.execJSCode"",""options"":{""content"":""// Current Component\r\nlet _component = context.getCurrentComponent()\r\n\r\n// Current Form\r\nlet  _form = _component.getForm()\r\n\r\n_form.resetFields()\r\n""}}]",10gd00000150QfGpNugy,2023-07-20 06:49:52,10gd00000150QfGpNugy,2023-07-20 06:49:52,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h000001547YBTaZo8,button_16_click,003g000001547OV6GsZk,"[{""type"":""$core.execJSCode"",""options"":{""content"":""// Current Component\r\nlet _component = context.getCurrentComponent()\r\n\r\n// Current Form\r\nlet  _form = _component.getForm()\r\n\r\n_form.resetFields()\r\n""}}]",10gd00000150QfGpNugy,2023-07-20 06:49:52,10gd00000150QfGpNugy,2023-07-20 06:49:52,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h000001547YBTaZo9,button_21_click,003g000001547OV6GsZk,"[{""type"":""$core.execJSCode"",""options"":{""content"":""$model.ref(\""showModal\"").setData(false);\r\n// Reset\r\ncontext.$component.get(\""Detail\"").resetFields();""}}]",10gd00000150QfGpNugy,2023-07-20 06:49:52,10gd00000150QfGpNugy,2023-07-20 06:49:52,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h000001547YBTaZoA,button_22_click,003g000001547OV6GsZk,"[{""type"":""$core.execJSCode"",""options"":{""content"":""context.$component.get(\""Detail\"").formValidate().then(function (valid) {\r\n    // Current Component\r\n    let table = context.$page.getComponentByName(\""Records\"");\r\n    const i18n = getI18n();\r\n    $model.ref('saveBtnLoading').setData(true);\r\n\r\n    $model.ref(\""Detail\"").save().then(data => {\r\n        // Success message\r\n        if (data.resCode == 0) {\r\n            context.$message.success(i18n.successInfo);\r\n            table.doQuery();\r\n            // Close the modal\r\n            $model.ref(\""showModal\"").setData(false);\r\n            // Reset\r\n            context.$component.get(\""Detail\"").resetFields();\r\n            setTimeout(function () {\r\n                $model.ref('saveBtnLoading').setData(false);\r\n            }, 1000);\r\n        }\r\n        else {\r\n            context.$message.error(i18n.failureInfo + data.resMsg, 5)\r\n            $model.ref('saveBtnLoading').setData(false);\r\n        }\r\n    }).catch(e => {\r\n        // Failure message\r\n        context.$message.error(i18n.failureInfo + e, 5)\r\n        $model.ref('saveBtnLoading').setData(false);\r\n    });\r\n});\r\n\r\nfunction getI18n() {\r\n    const locale = (context.$page.$page.$i18n || {}).locale || \""en_US\"";\r\n    const i18n = {\r\n        \""zh_CN\"": {\r\n            successInfo: '保存成功',\r\n            failureInfo: '保存失败：'\r\n        },\r\n        \""en_US\"": {\r\n            successInfo: 'Save Successfully',\r\n            failureInfo: 'Save Failed:'\r\n        }\r\n    };\r\n    return i18n[locale];\r\n}""}}]",10gd00000150QfGpNugy,2023-07-20 06:49:52,10gd00000150QfGpNugy,2023-07-20 06:49:52,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h000001547YBTaZoB,button_23_click,003g000001547OV6GsZk,"[{""type"":""$core.execJSCode"",""options"":{""content"":""context.$component.get(\""Detail\"").formValidate().then(function (valid) {\r\n    // Current Component\r\n    let table = context.$page.getComponentByName(\""Records\"");\r\n    const i18n = getI18n();\r\n\r\n    $model.ref(\""Detail\"").save().then(data => {\r\n        // Success message\r\n        if (data.resCode == 0) {\r\n            table.doQuery();\r\n            // Close modal\r\n            $model.ref(\""showModal\"").setData(false);\r\n            // Reset\r\n            setTimeout(function () {\r\n                context.$component.get(\""Detail\"").resetFields();\r\n            });\r\n            // Submit for approval\r\n            context.$approval(data.result[0].id).then(res => {\r\n                if (res.resCode == 0) {\r\n                    context.$message.success(i18n.successInfo);\r\n                }\r\n                else if (res.resCode == \""405230808\"") {\r\n                    $model.ref(\""showUserModal\"").setData(true);\r\n                    $model.ref(\""recordId\"").setData(data.result[0].id);\r\n                }\r\n                else {\r\n                    context.$message.error(i18n.submitFail + res.resMsg, 5)\r\n                }\r\n            })\r\n        }\r\n        else {\r\n            context.$message.error(i18n.failureInfo + data.resMsg, 5)\r\n        }\r\n    }).catch(e => {\r\n        // Failure message\r\n        context.$message.error(i18n.failureInfo + e, 5)\r\n    });\r\n});\r\n\r\n\r\nfunction getI18n() {\r\n    const locale = (context.$page.$page.$i18n || {}).locale || \""en_US\"";\r\n    const i18n = {\r\n        \""zh_CN\"": {\r\n            successInfo: '保存成功',\r\n            failureInfo: '保存失败：',\r\n            submitFail: \""提交审批失败：\""\r\n        },\r\n        \""en_US\"": {\r\n            successInfo: 'Save Successfully',\r\n            failureInfo: 'Save Failed:',\r\n            submitFail: \""Submit Approval Failed:\""\r\n        }\r\n    };\r\n    return i18n[locale];\r\n}""}}]",10gd00000150QfGpNugy,2023-07-20 06:49:52,10gd00000150QfGpNugy,2023-07-20 06:49:52,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h000001547YBTaZoC,modal_1_on-ok,003g000001547OV6GsZk,"[{""type"":""$core.execJSCode"",""options"":{""content"":""const i18n = getI18n();\r\n\r\ncontext.$approval($model.ref(\""recordId\"").getData(), $model.ref(\""approvalUser\"").getData()).then(res => {\r\n    if (res.resCode == 0) {\r\n        context.$message.success(i18n.successInfo);\r\n    }\r\n    else if (res.resCode == \""405230808\"") {\r\n        $model.ref(\""showUserModal\"").setData(true);\r\n    }\r\n    else {\r\n        context.$message.error(i18n.failureInfo + res.resMsg, 5)\r\n    }\r\n})\r\n\r\n\r\nfunction getI18n() {\r\n    const locale = (context.$page.$page.$i18n || {}).locale || \""en_US\"";\r\n    const i18n = {\r\n        \""zh_CN\"": {\r\n            successInfo: '保存成功',\r\n            failureInfo: '保存失败：'\r\n        },\r\n        \""en_US\"": {\r\n            successInfo: 'Save Successfully',\r\n            failureInfo: 'Save Failed:'\r\n        }\r\n    };\r\n    return i18n[locale];\r\n} ""}}]",10gd00000150QfGpNugy,2023-07-20 06:49:52,10gd00000150QfGpNugy,2023-07-20 06:49:52,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h000001547YBTaZoD,modal_0_on-ok,003g000001547OV6GsZk,"[{""type"":""$core.execJSCode"",""options"":{""content"":""// Current Component\r\nlet table = context.$page.getComponentByName(\""Records\"");\r\n\r\n// Get component by node name \r\nlet form = this.$component.get(\""Detail\"");\r\n\r\nconst i18n = getI18n();\r\n\r\n// Get the binding model of the component, call the save action to save the data\r\nform.getDataModel().save().then(data => {\r\n    // Success message\r\n    if (data.resCode == 0) {\r\n        context.$message.success(i18n.successInfo);\r\n        // Refresh table\r\n        table.doQuery();\r\n    }\r\n    else {\r\n        context.$message.error(i18n.failureInfo + data.resMsg, 5)\r\n    }\r\n}).catch(e => {\r\n    // Failure message\r\n    context.$message.error(i18n.failureInfo + e, 5)\r\n});\r\n\r\nfunction getI18n() {\r\n    const locale = (context.$page.$page.$i18n || {}).locale || \""en_US\"";\r\n    const i18n = {\r\n        \""zh_CN\"": {\r\n            successInfo: '保存成功',\r\n            failureInfo: '保存失败：'\r\n        },\r\n        \""en_US\"": {\r\n            successInfo: 'Save Successfully',\r\n            failureInfo: 'Save Failed:'\r\n        }\r\n    };\r\n    return i18n[locale];\r\n}""}}]",10gd00000150QfGpNugy,2023-07-20 06:49:52,10gd00000150QfGpNugy,2023-07-20 06:49:52,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h000001547YBTaZoE,button_0_click,003g000001547OV6GsZk,"[{""type"":""$core.execJSCode"",""options"":{""content"":""var modalTitle = {\""en_US\"":\""New\"",\""zh_CN\"":\""创建\""};\r\nvar _component = context.$component.current;\r\nvar locale = (_component._i18n  &&  _component._i18n.locale) || 'zh_CN';\r\nvar model = context.$page.getModel();\r\nmodel.modalTitle = modalTitle[locale] || modalTitle['zh_CN'];\r\n\r\n$model.ref(\""Detail\"").setData({});\r\n\r\n// Show the \""hideSaveNewBtn\"" button\r\n$model.ref(\""hideSaveNewBtn\"").setData(false);\r\n\r\n// Determine whether to display the \""hideApprovalBtn\"" button\r\ncontext.$object(\""Detail\"").then(objectMeta =>{\r\n    if(objectMeta && objectMeta.aprovalProcesses &&  objectMeta.aprovalProcesses.length > 0) {\r\n        $model.ref(\""hideApprovalBtn\"").setData(false);\r\n    }\r\n    else {\r\n        $model.ref(\""hideApprovalBtn\"").setData(true);\r\n    }\r\n    \r\n    // show modal\r\n    $model.ref(\""showModal\"").setData(true);\r\n});""},""key"":""1659940009648"",""__handlerName"":"""",""__nodeName"":""自定义JS代码""}]",10gd00000150QfGpNugy,2023-07-20 06:49:52,10gd00000150QfGpNugy,2023-07-20 06:49:52,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h000001547YBTaZoF,button_15_click,003g000001547OV6GsZk,"[{""type"":""$core.execJSCode"",""options"":{""content"":""// Current Component\r\nlet _component = context.getCurrentComponent()\r\n\r\n// Current Form\r\nlet  _form = _component.getForm()\r\n\r\n_form.formSave()\r\n""}}]",10gd00000150QfGpNugy,2023-07-20 06:49:52,10gd00000150QfGpNugy,2023-07-20 06:49:52,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h000001547YBTaZoG,button_24_click,003g000001547OV6GsZk,"[{""type"":""$core.execJSCode"",""options"":{""content"":""context.$component.get(\""Detail\"").formValidate().then(function (valid) {\r\n    // Current Component\r\n    let table = context.$page.getComponentByName(\""Records\"");\r\n    const i18n = getI18n();\r\n    $model.ref('saveNewBtnLoading').setData(true);\r\n\r\n    $model.ref(\""Detail\"").save().then(data => {\r\n        // Success message\r\n        if (data.resCode == 0) {\r\n            context.$message.success(i18n.successInfo);\r\n            table.doQuery();\r\n            // Clear data\r\n            $model.ref(\""Detail\"").setData({});\r\n            // Reset\r\n    context.$component.get(\""Detail\"").resetFields();\r\n        setTimeout(function () {\r\n                $model.ref('saveNewBtnLoading').setData(false);\r\n            }, 300);\r\n        }\r\n        else {\r\n            context.$message.error(i18n.failureInfo + data.resMsg, 5)\r\n            $model.ref('saveNewBtnLoading').setData(false);\r\n        }\r\n    }).catch(e => {\r\n        // Failure message\r\n        context.$message.error(i18n.failureInfo + e, 5)\r\n        $model.ref('saveNewBtnLoading').setData(false);\r\n    });\r\n});\r\n\r\nfunction getI18n() {\r\n    const locale = (context.$page.$page.$i18n || {}).locale || \""en_US\"";\r\n    const i18n = {\r\n        \""zh_CN\"": {\r\n            successInfo: '保存成功',\r\n            failureInfo: '保存失败：'\r\n        },\r\n        \""en_US\"": {\r\n            successInfo: 'Save Successfully',\r\n            failureInfo: 'Save Failed:'\r\n        }\r\n    };\r\n    return i18n[locale];\r\n}""}}]",10gd00000150QfGpNugy,2023-07-20 06:49:52,10gd00000150QfGpNugy,2023-07-20 06:49:52,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h000001547YBTaZoH,modal_on-cancel_1545208415426026,003g000001547OV6GsZk,"[{""type"":""$core.execJSCode"",""options"":{""content"":""// Reset\r\ncontext.$component.get(\""Detail\"").resetFields();""}}]",10gd00000150QfGpNugy,2023-07-20 06:49:52,10gd00000150QfGpNugy,2023-07-20 06:49:52,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h000001547YBTaZoI,butto_click_1545274225904000,003g000001547OV6GsZk,"[{""type"":""$core.execJSCode"",""options"":{""content"":""let _component = context.$component.current;\r\nvar modalTitle =  {\""en_US\"":\""Modify\"",\""zh_CN\"":\""修改\""};\r\nvar locale = (_component._i18n  &&  _component._i18n.locale) || 'zh_CN';\r\nvar model = context.$page.getModel();\r\nmodel.modalTitle = modalTitle[locale] || modalTitle['zh_CN'];\r\n\r\nlet curRow = _component.$attrs.row;\r\n\r\nlet formModel = $model.ref(\""Detail\"");\r\n\r\n$model.ref(\""hideApprovalBtn\"").setData(true);\r\n\r\n$model.ref(\""hideSaveNewBtn\"").setData(true);\r\n\r\nformModel.queryById(curRow.id).then(() => {\r\n    $model.ref(\""showModal\"").setData(true);\r\n});\r\n\r\n""},""key"":""1659939568569"",""__handlerName"":"""",""__nodeName"":""自定义JS代码""}]",10gd00000150QfGpNugy,2023-07-20 06:49:52,10gd00000150QfGpNugy,2023-07-20 06:49:52,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h0000015FkMDMGEjY,colla_on-click_1689837168180023,003g000001549BiiowTY,"[{""type"":""$core.execJSCode"",""options"":{""content"":""// 处理图标变化事件\r\nif($current.$parent.$options.propsData.collapseable){\r\n    // 处理当前节点的图标样式\r\n    for(let i=0; i < $current.$children.length; i++){\r\n        let child = $current.$children[i];\r\n        if(child.$options.name === 'XIcon'){\r\n            let node = $current.getPageComponent().getLayoutByKey(child.$el.getAttribute('layoutid'));\r\n            if($current.$parent.$data.isActive){\r\n                // 此处填写收起样式\r\n                child.typeClone = '{\""Name\"":\""fa-ss-collapse-3\"",\""ingorePrefix\"":true}';\r\n            }else{\r\n                // 此处填写展开样式\r\n                child.typeClone = '{\""Name\"":\""fa-ss-extend-3\"",\""ingorePrefix\"":true}';\r\n            }\r\n        }\r\n    }\r\n    // 在accordion情况下需要处理其他panel的图标样式\r\n    if($current.$parent.$parent.$options.propsData.accordion){\r\n        for(let i=0; i < $current.$parent.$parent.$children.length; i++){\r\n            let panel = $current.$parent.$parent.$children[i];\r\n            // 排除当前panel\r\n            if(panel.$el.getAttribute('layoutid') === $current.$parent.$el.getAttribute('layoutid')){\r\n                continue;\r\n            }\r\n            for(let j=0; j < panel.$children.length; j++){\r\n                let panelComp = panel.$children[j];\r\n                if(panelComp.$options.name === 'XCollapse2PanelCaption'){\r\n                    for(let k=0; k < panelComp.$children.length; k++){\r\n                        let child = panelComp.$children[k];\r\n                        if(child.$options.name === 'XIcon'){\r\n                            let node = $current.getPageComponent().getLayoutByKey(child.$el.getAttribute('layoutid'));\r\n                            child.typeClone = '{\""Name\"":\""fa-ss-collapse-3\"",\""ingorePrefix\"":true}';\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n// 面板展开/收起事件\r\n$current.$parent.toggle();""},""__nodeName"":""展开/收起事件"",""key"":1689837168180,""expand"":true}]",10gd00000150QfGpNugy,2023-07-27 06:56:35,10gd00000150QfGpNugy,2023-07-27 06:56:35,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h0000015FkMDMGEjZ,colla_on-click_1689837168180029,003g000001549BiiowTY,"[{""type"":""$core.execJSCode"",""options"":{""content"":""// 处理图标变化事件\r\nif($current.$parent.$options.propsData.collapseable){\r\n    // 处理当前节点的图标样式\r\n    for(let i=0; i < $current.$children.length; i++){\r\n        let child = $current.$children[i];\r\n        if(child.$options.name === 'XIcon'){\r\n            let node = $current.getPageComponent().getLayoutByKey(child.$el.getAttribute('layoutid'));\r\n            if($current.$parent.$data.isActive){\r\n                // 此处填写收起样式\r\n                child.typeClone = '{\""Name\"":\""fa-ss-collapse-3\"",\""ingorePrefix\"":true}';\r\n            }else{\r\n                // 此处填写展开样式\r\n                child.typeClone = '{\""Name\"":\""fa-ss-extend-3\"",\""ingorePrefix\"":true}';\r\n            }\r\n        }\r\n    }\r\n    // 在accordion情况下需要处理其他panel的图标样式\r\n    if($current.$parent.$parent.$options.propsData.accordion){\r\n        for(let i=0; i < $current.$parent.$parent.$children.length; i++){\r\n            let panel = $current.$parent.$parent.$children[i];\r\n            // 排除当前panel\r\n            if(panel.$el.getAttribute('layoutid') === $current.$parent.$el.getAttribute('layoutid')){\r\n                continue;\r\n            }\r\n            for(let j=0; j < panel.$children.length; j++){\r\n                let panelComp = panel.$children[j];\r\n                if(panelComp.$options.name === 'XCollapse2PanelCaption'){\r\n                    for(let k=0; k < panelComp.$children.length; k++){\r\n                        let child = panelComp.$children[k];\r\n                        if(child.$options.name === 'XIcon'){\r\n                            let node = $current.getPageComponent().getLayoutByKey(child.$el.getAttribute('layoutid'));\r\n                            child.typeClone = '{\""Name\"":\""fa-ss-collapse-3\"",\""ingorePrefix\"":true}';\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n// 面板展开/收起事件\r\n$current.$parent.toggle();""},""__nodeName"":""展开/收起事件"",""key"":1689837168180}]",10gd00000150QfGpNugy,2023-07-27 06:56:35,10gd00000150QfGpNugy,2023-07-27 06:56:35,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h0000015FkMDMGEja,Desig_on-load_1,003g000001549BiiowTY,"[{""type"":""$core.execJSCode"",""options"":{""content"":""$model.ref('equipmentOptions').setData({inputParam:{}});\n$model.ref('equipmentOptions').run().then(function(response){\nif(response.equipList){\n        $model.ref(\""equipmentList\"").setData(response.equipList);\n}\n});""},""key"":""1689841880922"",""__handlerName"":""javaScriptCodeHandler"",""__nodeName"":""自定义JS代码"",""expand"":true}]",10gd00000150QfGpNugy,2023-07-27 06:56:35,10gd00000150QfGpNugy,2023-07-27 06:56:35,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h0000015FkMDMGEjb,selec_on-change_1689837168180044,003g000001549BiiowTY,"[{""type"":""$core.execJSCode"",""options"":{""content"":""let equipment = $model.ref(\""basicInfo\"").getData();\nlet equipmentId = equipment.NPNM__equipmentId__CST; \nlet queryEquipParam = {\""id\"" : equipmentId}; \n$model.ref('equipmentOptions').setData({inputParam: queryEquipParam});\n$model.ref('equipmentOptions').run().then(function (response) { \n    if (response.equipment) {\n        $model.ref(\""equipmentInfo\"").setData(response.equipment);\n    }\n});""},""key"":""1689841961730"",""__handlerName"":""javaScriptCodeHandler"",""__nodeName"":""自定义JS代码""}]",10gd00000150QfGpNugy,2023-07-27 06:56:35,10gd00000150QfGpNugy,2023-07-27 06:56:35,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h0000015FkMDMGEjc,butto_click_1689841367136002,003g000001549BiiowTY,"[{""type"":""$core.execJSCode"",""options"":{""content"":""// 配置页面的bpm参数bp.name，通过submitTask方法启动BPM并提交工单数据workOrderData到BPM\ncontext.$page.params[\""bp.name\""] = \""NPNM__WorkOrderBpm\"";\nlet basicInfo = $model.get('basicInfo').getData();\nbasicInfo.NPNM__workOrderId__CST = basicInfo.NPNM__type__CST + \""_\"" + new Date().getTime();\nlet workOrderData = {\n    \""workOrderData\"": basicInfo\n};\ncontext.$bp.submitTask(workOrderData).then(function (resp) {\n    context.$page.loadStdPage('NPNM__manageWorkOrder');\n});\n""},""key"":""1689842145818"",""__handlerName"":""javaScriptCodeHandler"",""__nodeName"":""自定义JS代码""}]",10gd00000150QfGpNugy,2023-07-27 06:56:35,10gd00000150QfGpNugy,2023-07-27 06:56:35,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h0000015FkMDMGEjd,butto_click_1689841367136004,003g000001549BiiowTY,"[{""type"":""$core.execJSCode"",""options"":{""content"":""//返回工单列表页面\ncontext.$page.loadStdPage('NPNM__workOrderList');\n""},""key"":""1689842381376"",""__handlerName"":""javaScriptCodeHandler"",""__nodeName"":""自定义JS代码""}]",10gd00000150QfGpNugy,2023-07-27 06:56:35,10gd00000150QfGpNugy,2023-07-27 06:56:35,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h0000015CSU7m9FxY,butto_click_1689843694156046,003g00000154Gxbi58wS,"[{""type"":""$core.execJSCode"",""options"":{""content"":""let pageInfo = $model.ref('table_0_condition').getData().pageInfo;\nlet queryInfo = $model.ref('table_0_condition').getData().queryInfo;\nif (!queryInfo) {\n    queryInfo = {};\n}\nlet queryData = {\n    \""title\"": queryInfo.title,\n    \""status\"": queryInfo.status,\n    \""createdBy\"": queryInfo.createdBy,\n    \""start\"": 0,\n    \""limit\"": pageInfo.pageSize\n};\n$model.ref('queryWorkOrder').setData({ inputParam: queryData });\n$model.ref('queryWorkOrder').run().then(function (data) {\n    $model.ref('workOrderInstance').setData(data.workOrderList);\n    pageInfo.total = parseInt(data.total);\n    $model.ref('table_0_condition').setData({ \""pageInfo\"": pageInfo });\n}).catch(function (error) {\n    console.log('error is', error);\n});""},""key"":""1689844517594"",""__handlerName"":""javaScriptCodeHandler"",""__nodeName"":""自定义JS代码""}]",10gd00000150QfGpNugy,2023-07-25 07:23:40,10gd00000150QfGpNugy,2023-07-25 07:23:40,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h0000015CSU7m9FxZ,Desig_on-load_1,003g00000154Gxbi58wS,"[{""type"":""$core.execJSCode"",""options"":{""content"":""let pageInfo = $model.ref('table_0_condition').getData().pageInfo;\nlet queryData = {\n    \""start\"": (pageInfo.curPage - 1) * pageInfo.pageSize,\n    \""limit\"": pageInfo.pageSize\n};\n$model.ref('queryWorkOrder').setData({ inputParam: queryData });\n$model.ref('queryWorkOrder').run().then(function (data) {\n    $model.ref('workOrderInstance').setData(data.workOrderList);\n    pageInfo.total = parseInt(data.total);\n    $model.ref('table_0_condition').setData({ \""pageInfo\"": pageInfo });\n}).catch(function (error) {\n    console.log('error is', error);\n});""},""key"":""1689845139394"",""__handlerName"":""javaScriptCodeHandler"",""__nodeName"":""自定义JS代码"",""expand"":true}]",10gd00000150QfGpNugy,2023-07-25 07:23:40,10gd00000150QfGpNugy,2023-07-25 07:23:40,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h0000015CSU7m9Fxa,butto_click_1689843694156006,003g00000154Gxbi58wS,"[{""type"":""$core.execJSCode"",""options"":{""content"":""//打开创建工单页面，需要根据实际页面名称修改\r\ncontext.$page.load('/besBaas/page#/NPNM__createWorkOrder')""},""key"":""1689844198917"",""__handlerName"":"""",""__nodeName"":""新增行""}]",10gd00000150QfGpNugy,2023-07-25 07:23:40,10gd00000150QfGpNugy,2023-07-25 07:23:40,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h0000015AUqabC0ps,Desig_on-load_1,003g00000155x93QWh9c,"[{""type"":""$core.execJSCode"",""options"":{""content"":""var workOrderId = Page.params.workOrderId;\n$model.ref(\""transInfo\"").setData({ \""NPNM__workOrderId__CST\"": workOrderId });\n//查询维修人员列表，作为维修人员下拉框的可选值\n$model.ref('workerOptions').setData({ inputParam: {} });\n$model.ref('workerOptions').run();""},""key"":""1689931549623"",""__handlerName"":""javaScriptCodeHandler"",""__nodeName"":""自定义JS代码""}]",10gd00000150QfGpNugy,2023-07-24 03:01:31,10gd00000150QfGpNugy,2023-07-24 03:01:31,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h0000015AXzBnoBf6,butto_click_1689928504565010,003g00000155xvGFqkXw,"[{""type"":""$core.execJSCode"",""options"":{""content"":""let pageInfo = $model.ref('table_0_condition').getData().pageInfo;\nlet queryInfo = $model.ref('table_0_condition').getData().queryInfo;\nif (!queryInfo) {\n    queryInfo = {};\n}\nlet queryData = {\n    \""title\"": queryInfo.title,\n    \""status\"": queryInfo.status,\n    \""createdBy\"": queryInfo.createdBy,\n    \""start\"": 0,\n    \""limit\"": pageInfo.pageSize\n};\n$model.ref('queryWorkOrder').setData({ inputParam: queryData });\n$model.ref('queryWorkOrder').run().then(function (data) {\n    $model.ref('workOrderInstance').setData(data.workOrderList);\n    pageInfo.total = parseInt(data.total);\n    $model.ref('table_0_condition').setData({ \""pageInfo\"": pageInfo });\n}).catch(function (error) {\n    console.log('error is', error);\n});""},""key"":""1689844517594"",""__handlerName"":""javaScriptCodeHandler"",""__nodeName"":""自定义JS代码""}]",10gd00000150QfGpNugy,2023-07-24 03:45:26,10gd00000150QfGpNugy,2023-07-24 03:45:26,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h0000015AXzBnoBf7,Desig_on-load_1,003g00000155xvGFqkXw,"[{""type"":""$core.execJSCode"",""options"":{""content"":""var pageInfo = $model.ref('table_0_condition').getData().pageInfo;\nvar queryData = {\n    \""start\"": (pageInfo.curPage - 1) * pageInfo.pageSize,\n    \""limit\"": pageInfo.pageSize\n};\n$model.ref('queryWorkOrder').setData({ inputParam: queryData });\n$model.ref('queryWorkOrder').run().then(function (data) {\n    $model.ref('workOrderInstance').setData(data.workOrderList);\n    pageInfo.total = parseInt(data.total);\n    $model.ref('table_0_condition').setData({ \""pageInfo\"": pageInfo });\n}).catch(function (error) {\n    console.log('error is', error);\n});""},""key"":""1689845139394"",""__handlerName"":""javaScriptCodeHandler"",""__nodeName"":""自定义JS代码""}]",10gd00000150QfGpNugy,2023-07-24 03:45:26,10gd00000150QfGpNugy,2023-07-24 03:45:26,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h0000015AXzBnoBf8,butto_click_1689931822931002,003g00000155xvGFqkXw,"[{""type"":""$core.execJSCode"",""options"":{""content"":""var _component = context.$component.current;\n// 配置页面的bpm参数\ncontext.$page.params[\""bp.name\""] = \""NPNM__WorkOrderBpm\"";\nvar currentRow = _component.$attrs.row;\nvar workOrderId = currentRow.NPNM__workOrderId__CST;\nvar instanceId = currentRow.NPNM__instanceId__CST;\nvar taskId = \""\"";\nvar _model = $model.ref(\""workOrderInstance\"");\ncontext.$dialog.popup(\n    {\n        title: '处理工单',     //弹出框标题\n        page: 'NPNM__workOrderDispatch', // 弹出页面名称\n        footerHide: false,\n        width: 20, //宽，小于100为百分比，大于100为px\n        height: 250, // 高px\n        okText: '确定',\n        cancelText: '取消',\n        params: {\n            \""workOrderId\"": workOrderId\n        }, //页面参数\n        onCancel: function()  {\n            $model.ref(\""transInfo\"").setData({});\n        },  // 取消时，回调\n        onOk: function()  {\n            // 确定时，回调\n            //debugger;\n            var transInfo = { \""transInfo\"": $model.ref(\""transInfo\"").getData() };\n            var taskData = {\n                \""action\"": \""complete\"",\n                \""variables\"": transInfo\n            };\n \n            // 获取csrf token\n            context.$utils.getCSRFToken().then(function (token) {\n                var url = '/u-route/baas/bp/v2.0/query/tasks?flag=activeTask&rootID=' + instanceId;\n                fetch(url, {\n                    method: 'GET',\n                    headers: {\n                        'Content-Type': 'application/json',\n                        'CSRF-Token': token\n                    }\n                }).then(function (resp) {\n                    resp.json().then(function (data) {\n                        taskId = data.result.Recs[0].id;\n                        var url2 = '/u-route/baas/bp/v2.0/runtime/tasks/' + taskId;\n                        fetch(url2, {\n                            method: 'PUT',\n                            headers: {\n                                'Content-Type': 'application/json'\n                            },\n                            body: JSON.stringify(taskData)\n                        }).then(function (resp) {\n                            context.$message.success('派发成功');\n                            var pageInfo = $model.ref('table_0_condition').getData().pageInfo;\n                            var queryData = {\n                                \""start\"": (pageInfo.curPage - 1) * pageInfo.pageSize,\n                                \""limit\"": pageInfo.pageSize\n                            };\n                            $model.ref('queryWorkOrder').setData({ inputParam: queryData });\n                            $model.ref('queryWorkOrder').run().then(function (data) {\n                                $model.ref('workOrderInstance').setData(data.workOrderList);\n                                pageInfo.total = parseInt(data.total);\n                                $model.ref('table_0_condition').setData({ \""pageInfo\"": pageInfo });\n                            }).catch(function (error) {\n                                console.log('error is', error);\n                            });\n                        }).catch(function (error) {\n                            console.log('error is', error);\n                        });\n                    });\n                }).catch(function (error) {\n                    console.log('error is', error);\n                });\n            });\n        }\n    }\n);""},""key"":""1689932019181"",""__handlerName"":""javaScriptCodeHandler"",""__nodeName"":""自定义JS代码""}]",10gd00000150QfGpNugy,2023-07-24 03:45:26,10gd00000150QfGpNugy,2023-07-24 03:45:26,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h0000015C9BsMvyCG,Desig_on-load_1,003g0000015Ac2zwFhHk,"[{""type"":""$core.execJSCode"",""options"":{""content"":""var id = Page.params.id;\n$model.ref(\""statusInfo\"").setData({ \""id\"": id });\n$model.ref('statusOptions').setData({ inputParam: { \""id\"": id } });\n$model.ref('statusOptions').run();""},""key"":""1690174075583"",""__handlerName"":""javaScriptCodeHandler"",""__nodeName"":""自定义JS代码"",""expand"":true}]",10gd00000150QfGpNugy,2023-07-25 02:53:40,10gd00000150QfGpNugy,2023-07-25 02:53:40,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h0000015AuM7oYttY,Desig_on-load_1,003g0000015AmYeW87NI,"[{""type"":""$core.execJSCode"",""options"":{""content"":""$model.ref('queryWorkOrder').setData({inputParam: {\""isFME\"": true}});\n$model.ref('queryWorkOrder').run().then(function (data) { \n    if (data && data.workOrderList) {\n        //将查询到的数据赋值给页面模型来展示\n        $model.ref('workOrderList').setData(data.workOrderList);\n    }\n}).catch(function (error) {\n    console.log('error is', error);\n});""},""key"":""1690185707213"",""__handlerName"":""javaScriptCodeHandler"",""__nodeName"":""自定义JS代码""}]",10gd00000150QfGpNugy,2023-07-24 08:58:28,10gd00000150QfGpNugy,2023-07-24 08:58:28,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h0000015AuM7oYttZ,butto_click_1690182561418007,003g0000015AmYeW87NI,"[{""type"":""$core.execJSCode"",""options"":{""content"":""var queryTitle = $model.ref('queryCondition').getData().title;\n$model.ref('queryWorkOrder').setData({ inputParam: { \""title\"": queryTitle, \""isFME\"": true } });\n$model.ref('queryWorkOrder').run().then(function (data) {\n    if (data && data.workOrderList) {\n        //将查询到的数据赋值给页面模型来展示\n        $model.ref('workOrderList').setData(data.workOrderList);\n    }\n}).catch(function (error) {\n    console.log('error is', error);\n});""},""key"":""1690188304224"",""__handlerName"":""javaScriptCodeHandler"",""__nodeName"":""自定义JS代码""}]",10gd00000150QfGpNugy,2023-07-24 08:58:28,10gd00000150QfGpNugy,2023-07-24 08:58:28,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h0000015AuM7oYtta,butto_click_1690182561418051,003g0000015AmYeW87NI,"[{""type"":""$core.execJSCode"",""options"":{""content"":""//获取当前组件（即button）\nvar _component = context.$component.current;\n// 配置页面的bpm参数\ncontext.$page.params[\""bp.name\""] = \""NPNM__WorkOrderBpm\"";\n//获取当前行id\nvar id = _component.$attrs.row.id;\nvar taskId = \""\"";\nvar instanceId = \""\"";\n//遍历获取当前行内容\nvar row = {};\nvar workorders = $model.ref('workOrderList').getData();\nworkorders.forEach(function (wo, idx) {\n    if (wo.id == id) {\n        row = wo;\n        instanceId = wo.NPNM__instanceId__CST;\n    }\n}); \n//打开处理弹框\ncontext.$dialog.popup({\n    title: '处理工单',\n    page: 'NPNM__workOrderProcess',\n    footerHide: false,\n    width: 20,\n    height: 180,\n    okText: '提交',\n    cancelText: '取消',\n    params: { id: id, row: row },\n    onCancel: function () {\n    },\n    onOk: function () {\n        var statusInfo = { \""statusInfo\"": $model.ref(\""statusInfo\"").getData() };\n        var taskData = {\n            \""action\"": \""complete\"",\n            \""variables\"": statusInfo\n        };\n \n        // 获取csrf token\n        context.$utils.getCSRFToken().then(function (token) {\n            var url = '/u-route/baas/bp/v2.0/query/tasks?flag=activeTask&rootID=' + instanceId;\n            fetch(url, {\n                method: 'GET',\n                headers: {\n                    'Content-Type': 'application/json',\n                    'CSRF-Token': token\n                }\n            }).then(function (resp) {\n                resp.json().then(function (data) {\n                    taskId = data.result.Recs[0].id;\n                    var url2 = '/u-route/baas/bp/v2.0/runtime/tasks/' + taskId;\n                    fetch(url2, {\n                        method: 'PUT',\n                        headers: {\n                            'Content-Type': 'application/json'\n                        },\n                        body: JSON.stringify(taskData)\n                    }).then(function (resp) {\n                        context.$message.success('处理成功');\n                        $model.ref('queryWorkOrder').setData({ inputParam: {\""isFME\"": true} });\n                        $model.ref('queryWorkOrder').run().then(function (data) {\n                            if (data && data.workOrderList) {\n                                //将查询到的数据赋值给页面模型来展示\n                                $model.ref('workOrderList').setData(data.workOrderList);\n                            }\n                        }).catch(function (error) {\n                            console.log('error is', error);\n                        });\n                    }).catch(function (error) {\n                        console.log('error is', error);\n                    });\n                });\n            }).catch(function (error) {\n                console.log('error is', error);\n            });\n        });\n    }\n});""},""key"":""1690188507707"",""__handlerName"":""javaScriptCodeHandler"",""__nodeName"":""自定义JS代码""}]",10gd00000150QfGpNugy,2023-07-24 08:58:28,10gd00000150QfGpNugy,2023-07-24 08:58:28,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h0000015C1acDn3zc,butto_click_1690246010087010,003g0000015C0AEpPJR2,"[{""type"":""$core.execJSCode"",""options"":{""content"":""let pageInfo = $model.ref('table_0_condition').getData().pageInfo;\nlet queryInfo = $model.ref('table_0_condition').getData().queryInfo;\nif (!queryInfo) {\n    queryInfo = {};\n}\nlet queryData = {\n    \""title\"": queryInfo.title,\n    \""status\"": queryInfo.status,\n    \""createdBy\"": queryInfo.createdBy,\n    \""start\"": 0,\n    \""limit\"": pageInfo.pageSize\n};\n$model.ref('queryWorkOrder').setData({ inputParam: queryData });\n$model.ref('queryWorkOrder').run().then(function (data) {\n    $model.ref('workOrderInstance').setData(data.workOrderList);\n    pageInfo.total = parseInt(data.total);\n    $model.ref('table_0_condition').setData({ \""pageInfo\"": pageInfo });\n}).catch(function (error) {\n    console.log('error is', error);\n});""},""key"":""1689844517594"",""__handlerName"":""javaScriptCodeHandler"",""__nodeName"":""自定义JS代码""}]",10gd00000150QfGpNugy,2023-07-25 01:07:18,10gd00000150QfGpNugy,2023-07-25 01:07:18,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h0000015C1acDn3zd,Desig_on-load_1,003g0000015C0AEpPJR2,"[{""type"":""$core.execJSCode"",""options"":{""content"":""var pageInfo = $model.ref('table_0_condition').getData().pageInfo;\nvar queryData = {\n    \""start\"": (pageInfo.curPage - 1) * pageInfo.pageSize,\n    \""limit\"": pageInfo.pageSize\n};\n$model.ref('queryWorkOrder').setData({ inputParam: queryData });\n$model.ref('queryWorkOrder').run().then(function (data) {\n    $model.ref('workOrderInstance').setData(data.workOrderList);\n    pageInfo.total = parseInt(data.total);\n    $model.ref('table_0_condition').setData({ \""pageInfo\"": pageInfo });\n}).catch(function (error) {\n    console.log('error is', error);\n});""},""key"":""1689845139394"",""__handlerName"":""javaScriptCodeHandler"",""__nodeName"":""自定义JS代码""}]",10gd00000150QfGpNugy,2023-07-25 01:07:18,10gd00000150QfGpNugy,2023-07-25 01:07:18,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h0000015C1acDn3ze,butto_click_1689931822931002,003g0000015C0AEpPJR2,"[{""type"":""$core.execJSCode"",""options"":{""content"":""var _component = context.$component.current;\n// 配置页面的bpm参数\ncontext.$page.params[\""bp.name\""] = \""NPNM__WorkOrderBpm\"";\nvar currentRow = _component.$attrs.row;\nvar workOrderId = currentRow.NPNM__workOrderId__CST;\nvar instanceId = currentRow.NPNM__instanceId__CST;\nvar taskId = \""\"";\nvar _model = $model.ref(\""workOrderInstance\"");\ncontext.$dialog.popup(\n    {\n        title: '处理工单',     //弹出框标题\n        page: 'NPNM__workOrderDispatch', // 弹出页面名称\n        footerHide: false,\n        width: 20, //宽，小于100为百分比，大于100为px\n        height: 250, // 高px\n        okText: '确定',\n        cancelText: '取消',\n        params: {\n            \""workOrderId\"": workOrderId\n        }, //页面参数\n        onCancel: function()  {\n            $model.ref(\""transInfo\"").setData({});\n        },  // 取消时，回调\n        onOk: function()  {\n            // 确定时，回调\n            //debugger;\n            var transInfo = { \""transInfo\"": $model.ref(\""transInfo\"").getData() };\n            var taskData = {\n                \""action\"": \""complete\"",\n                \""variables\"": transInfo\n            };\n \n            // 获取csrf token\n            context.$utils.getCSRFToken().then(function (token) {\n                var url = '/u-route/baas/bp/v2.0/query/tasks?flag=activeTask&rootID=' + instanceId;\n                fetch(url, {\n                    method: 'GET',\n                    headers: {\n                        'Content-Type': 'application/json',\n                        'CSRF-Token': token\n                    }\n                }).then(function (resp) {\n                    resp.json().then(function (data) {\n                        taskId = data.result.Recs[0].id;\n                        var url2 = '/u-route/baas/bp/v2.0/runtime/tasks/' + taskId;\n                        fetch(url2, {\n                            method: 'PUT',\n                            headers: {\n                                'Content-Type': 'application/json'\n                            },\n                            body: JSON.stringify(taskData)\n                        }).then(function (resp) {\n                            context.$message.success('派发成功');\n                            var pageInfo = $model.ref('table_0_condition').getData().pageInfo;\n                            var queryData = {\n                                \""start\"": (pageInfo.curPage - 1) * pageInfo.pageSize,\n                                \""limit\"": pageInfo.pageSize\n                            };\n                            $model.ref('queryWorkOrder').setData({ inputParam: queryData });\n                            $model.ref('queryWorkOrder').run().then(function (data) {\n                                $model.ref('workOrderInstance').setData(data.workOrderList);\n                                pageInfo.total = parseInt(data.total);\n                                $model.ref('table_0_condition').setData({ \""pageInfo\"": pageInfo });\n                            }).catch(function (error) {\n                                console.log('error is', error);\n                            });\n                        }).catch(function (error) {\n                            console.log('error is', error);\n                        });\n                    });\n                }).catch(function (error) {\n                    console.log('error is', error);\n                });\n            });\n        }\n    }\n);""},""key"":""1689932019181"",""__handlerName"":""javaScriptCodeHandler"",""__nodeName"":""自定义JS代码""}]",10gd00000150QfGpNugy,2023-07-25 01:07:18,10gd00000150QfGpNugy,2023-07-25 01:07:18,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h0000015C1acDn3zf,butto_click_1690246043220028,003g0000015C0AEpPJR2,"[{""type"":""$core.execJSCode"",""options"":{""content"":""var _component = context.$component.current\nvar currentRow = _component.$attrs.row;\nvar id = currentRow.id;\nvar _model = $model.ref(\""workOrderInstance\"");\ncontext.$dialog.confirm(\n    {\n        title: '确认',\n        content: '确认删除该工单吗？',\n        okText: '确定',\n        cancelText: '取消',\n        onOk: function() {\n            $model.ref('deleteWorkOrder').setData({ inputParam: { \""id\"": id } });\n            $model.ref('deleteWorkOrder').run().then(function (data) {\n                var pageInfo = $model.ref('table_0_condition').getData().pageInfo;\n                var queryData = {\n                    \""start\"": (pageInfo.curPage - 1) * pageInfo.pageSize,\n                    \""limit\"": pageInfo.pageSize\n                };\n                $model.ref('queryWorkOrder').setData({ inputParam: queryData });\n                $model.ref('queryWorkOrder').run().then(function (data) {\n                    $model.ref('workOrderInstance').setData(data.workOrderList);\n                    pageInfo.total = parseInt(data.total);\n                    $model.ref('table_0_condition').setData({ \""pageInfo\"": pageInfo });\n                }).catch(function (error) {\n                    console.log('error is', error);\n                });\n            });\n        },\n        onCancel: function() { }\n    }\n);""},""key"":""1690246369449"",""__handlerName"":""javaScriptCodeHandler"",""__nodeName"":""自定义JS代码""}]",10gd00000150QfGpNugy,2023-07-25 01:07:18,10gd00000150QfGpNugy,2023-07-25 01:07:18,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h0000015C1acDn3zg,butto_click_1690246043220002,003g0000015C0AEpPJR2,"[{""type"":""$core.execJSCode"",""options"":{""content"":""// 当前表格\r\nvar _table = context.$component.table;\r\n\r\n// 初始化行数据\r\nvar newRow = _table.rowInit();\r\n\r\n// 添加新行\r\n_table.addrow(newRow);\r\n\r\n//打开创建工单页面，需要根据实际页面名称修改\r\ncontext.$page.load('/besBaas/page#/NPNM__createWorkOrder')""},""key"":""1690246183950"",""__handlerName"":"""",""__nodeName"":""新增行""}]",10gd00000150QfGpNugy,2023-07-25 01:07:18,10gd00000150QfGpNugy,2023-07-25 01:07:18,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h0000015DorR4eUyW,butto_click_1690338815174006,003g0000015Dmeoc8qQ4,"[{""type"":""$core.execJSCode"",""options"":{""content"":""let _table = context.$component.table;\r\ncontext.$dialog.popup(\r\n    { \r\n        title: '新增用户',     //弹出框标题\r\n        page: 'NPNM__registerPortalUser', // 弹出页面名称\r\n        footerHide:false,\r\n        width:40, //宽，小于100为百分比，大于100为px\r\n        height:450, // 高px\r\n        okText: '确定',\r\n        cancelText: '取消',\r\n        onCancel: () => {\r\n            $model.ref(\""userInfo\"").setData({});\r\n        },  // 取消时回调\r\n        onOk: () => {\r\n            // 确定时回调\r\n            //debugger;\r\n            let userInfo = $model.ref(\""userInfo\"").getData();\r\n            $model.ref('registerUser').setData({inputParam: userInfo});\r\n            $model.ref('registerUser').run().then(function (data) {     \r\n                if (data && data.msg){\r\n                    context.$message.success(data.msg);\r\n                    _table.doQuery();\r\n                }\r\n            }).catch(function (error) {\r\n                console.log('error is', error);\r\n                context.$message.error(error.resMsg);\r\n            });\r\n        }\r\n    }\r\n)""},""key"":""1690339534256"",""__handlerName"":"""",""__nodeName"":""新增行""}]",10gd00000150QfGpNugy,2023-07-26 03:04:23,10gd00000150QfGpNugy,2023-07-26 03:04:23,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h0000015ED5y2UWCe,Desig_on-load_1,003g0000015E1h8pzvAe,"[{""type"":""$core.execJSCode"",""options"":{""content"":""//加载地图API做地址转换用\nwindow.initMap = function (gis) {\n    window.gisMap = gis.loadMap({\n        container: document.getElementById('map'),\n        center: [114.0578388103, 22.6565079747],\n        zoom: 4,\n        viewMode: '2D',\n        mapStyle: 'normal',\n        layers: [],\n    });\n};\n//等待页面加载完成，发事件给地图widget初始化页面\nvar interval = setInterval(function () {\n    if (gis) {\n        clearInterval(interval);\n        new gis.Hmap2D(\""BAIDU_MAP\"", \""N1XIMTXn6wg8PyAMS34utWkOhWiFcw90\"", initMap);\n    }\n}, 300);\n//debugger;\n//为级联组件下拉框赋值\n$model.ref('cascaderOptions').setData([{ \""value\"": \""110000000000\"", \""label\"": \""北京市\"", \""children\"": [{ \""value\"": \""110100000000\"", \""label\"": \""市辖区\"", \""children\"": [{ \""value\"": \""110101000000\"", \""label\"": \""东城区\"" }, { \""value\"": \""110102000000\"", \""label\"": \""西城区\"" }, { \""value\"": \""110105000000\"", \""label\"": \""朝阳区\"" }, { \""value\"": \""110108000000\"", \""label\"": \""海淀区\"" }] }] }, { \""value\"": \""310000000000\"", \""label\"": \""上海市\"", \""children\"": [{ \""value\"": \""310100000000\"", \""label\"": \""市辖区\"", \""children\"": [{ \""value\"": \""310101000000\"", \""label\"": \""黄浦区\"" }, { \""value\"": \""310104000000\"", \""label\"": \""徐汇区\"" }, { \""value\"": \""310106000000\"", \""label\"": \""静安区\"" }, { \""value\"": \""310115000000\"", \""label\"": \""浦东新区\"" }, { \""value\"": \""310110000000\"", \""label\"": \""杨浦区\"" }, { \""value\"": \""310112000000\"", \""label\"": \""闵行区\"" }] }] }, { \""value\"": \""440000000000\"", \""label\"": \""广东省\"", \""children\"": [{ \""value\"": \""440100000000\"", \""label\"": \""广州市\"", \""children\"": [{ \""value\"": \""440101000000\"", \""label\"": \""市辖区\"" }, { \""value\"": \""440105000000\"", \""label\"": \""海珠区\"" }, { \""value\"": \""440106000000\"", \""label\"": \""天河区\"" }, { \""value\"": \""440111000000\"", \""label\"": \""白云区\"" }, { \""value\"": \""440113000000\"", \""label\"": \""番禺区\"" }] }, { \""value\"": \""440300000000\"", \""label\"": \""深圳市\"", \""children\"": [{ \""value\"": \""440301000000\"", \""label\"": \""市辖区\"" }, { \""value\"": \""440303000000\"", \""label\"": \""罗湖区\"" }, { \""value\"": \""440304000000\"", \""label\"": \""福田区\"" }, { \""value\"": \""440305000000\"", \""label\"": \""南山区\"" }, { \""value\"": \""440306000000\"", \""label\"": \""宝安区\"" }, { \""value\"": \""440307000000\"", \""label\"": \""龙岗区\"" }, { \""value\"": \""440308000000\"", \""label\"": \""盐田区\"" }, { \""value\"": \""440309000000\"", \""label\"": \""龙华区\"" }, { \""value\"": \""440310000000\"", \""label\"": \""坪山区\"" }] }] }]);\n//从页面url中获取id，然后将id作为queryEquipmentDatail的入参\nlet id = Page.params.id;\nif (id && id != \""\"") {\n    let _model = $model.ref(\""queryEquipmentDetail\"");\n    _model.setValue(\""inputParam\"", { \""equipmentId\"": id });\n    _model.run().then(() => {\n        //获取queryEquipmentDetail的出参后赋值给页面表单模型equipmentForm\n        var data = _model.getData();\n        if (data.outputParam && data.outputParam.equipment) {\n            var equip = data.outputParam.equipment;\n            $model.ref(\""equipmentForm\"").setData(equip);\n        }\n    }).catch((e) => {\n        this.$dialog.error({\n            title: '错误',\n            content: e.resMsg\n        })\n    });\n}""},""key"":""1690352864973"",""__handlerName"":""javaScriptCodeHandler"",""__nodeName"":""自定义JS代码"",""expand"":true}]",10gd00000150QfGpNugy,2023-07-26 08:43:31,10gd00000150QfGpNugy,2023-07-26 08:43:31,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h0000015ED5y2UWCf,butto_click_1690351440629019,003g0000015E1h8pzvAe,"[{""type"":""$core.execJSCode"",""options"":{""content"":""//debugger;\n// 当前组件\nlet _component = context.$component.current;\n//校验表单\n_component.getForm().formValidate().then((val) => {\n    //校验成功\n    //从自定义模型equipmentForm中获取界面表单数据\n    let data = $model.ref('equipmentForm').getData();\n    if (data) {\n        console.log(data);\n        //构造Script（editEquipment）的其他入参\n        let inputs = data;\n        inputs.NPNM__installationSiteProvince__CST = \""\"";//构造参数名称要与Object字段名保持一致\n        inputs.NPNM__installationSiteCity__CST = \""\"";\n        inputs.NPNM__installationSiteArea__CST = \""\"";\n        inputs.NPNM__fullAddress__CST = \""\"";\n        inputs.NPNM__longitude__CST = \""\"";\n        inputs.NPNM__latitude__CST = \""\"";\n        //获取服务模型editEquipment，执行模型的action，即执行模型关联的Script\n        let _model = $model.ref('editEquipment');\n        if (!inputs.cascaderAddress || inputs.cascaderAddress.length < 1) {\n            _model.setValue('inputParam', { \""equipment\"": inputs });\n            _model.run().then(() => {\n                //提交成功后返回设备列表页面\n                context.$page.load('/besBaas/page#/NPNM__equipmentManage');\n            }).catch((e) => {\n                this.$dialog.error({\n                    title: '错误',\n                    content: e.resMsg\n                })\n            });\n        }\n        else {\n            console.log('data');\n            //将级联框的内容转换为Script（editEquipment）的省、市、区3个参数，并拼接完整地址\n            let fullAddress = \""\"";\n            let cascaderOptions = $model.ref('cascaderOptions').getData();\n            if (cascaderOptions.length < 1) {\n                throw new Error(\""CascaderOptions data is wrong.\"");\n            }\n            cascaderOptions.forEach(function (province, idx) {\n                if (province.value == inputs.cascaderAddress[0]) {\n                    //构造参数名称要与Object字段名保持一致\n                    inputs.NPNM__installationSiteProvince__CST = inputs.cascaderAddress[0];\n                    fullAddress += province.label;\n                    if (inputs.cascaderAddress.length > 1) {\n                        province.children.forEach(function (city, idxCity) {\n                            if (city.value == inputs.cascaderAddress[1]) {\n                                //构造参数名称要与Object字段名保持一致\n                                inputs.NPNM__installationSiteCity__CST = inputs.cascaderAddress[1];\n                                fullAddress += city.label;\n                                if (inputs.cascaderAddress.length > 2) {\n                                    city.children.forEach(function (area, idxArea) {\n                                        if (area.value == inputs.cascaderAddress[2]) {\n                                            //构造参数名称要与Object字段名保持一致\n                                            inputs.NPNM__installationSiteArea__CST = inputs.cascaderAddress[2];\n                                            fullAddress += area.label;\n                                            return false;\n                                        }\n                                    });\n                                }\n                                return false;\n                            }\n                        });\n                    }\n                    return false;\n                }\n            });\n            //界面上输入了详细地址时，拼接出fullAddress完整地址\n            if (inputs.NPNM__installationDetailAddress__CST) {\n                fullAddress += inputs.NPNM__installationDetailAddress__CST;\n            }\n            if (fullAddress) {\n                inputs.NPNM__fullAddress__CST = fullAddress;\n                //调用百度地图API，根据fullAddress完整地址，计算出经纬度坐标\n                //debugger;\n                var geocoder = gisMap.getGeocoder();\n                geocoder.getPoint(fullAddress, function (status, result) {\n                    //转换完成后，将结果存入服务编排：editEquipment的入参中\n                    if (result && result.lat && result.lng) {\n                        inputs.NPNM__longitude__CST = result.lng + \""\"";\n                        inputs.NPNM__latitude__CST = result.lat + \""\"";\n                    }\n                    _model.setValue('inputParam', { \""equipment\"": inputs });\n                    _model.run().then(() => {\n                        context.$page.load('/besBaas/page#/NPNM__equipmentManage');\n                    }).catch((e) => {\n                        this.$dialog.error({\n                            title: '错误',\n                            content: e.resMsg\n                        })\n                    });\n                });//增加\n            }\n            else {\n                _model.setValue('inputParam', { \""equipment\"": inputs });\n                _model.run().then(() => {\n                    //提交成功后返回设备列表页面\n                    context.$page.load('/besBaas/page#/NPNM__equipmentManage');\n                }).catch((e) => {\n                    this.$dialog.error({\n                        title: '错误',\n                        content: e.resMsg\n                    })\n                });\n            }\n        }\n    }\n}).catch((error) => {\n});""},""key"":""1690352917218"",""__handlerName"":""javaScriptCodeHandler"",""__nodeName"":""自定义JS代码""}]",10gd00000150QfGpNugy,2023-07-26 08:43:31,10gd00000150QfGpNugy,2023-07-26 08:43:31,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
003h0000015ED5y2UWCg,butto_click_1690351440629020,003g0000015E1h8pzvAe,"[{""type"":""$core.execJSCode"",""options"":{""content"":""//返回设备列表页面\ncontext.$page.load('/besBaas/page#/NPNM__equipmentManage');""},""key"":""1690352988133"",""__handlerName"":""javaScriptCodeHandler"",""__nodeName"":""自定义JS代码""}]",10gd00000150QfGpNugy,2023-07-26 08:43:31,10gd00000150QfGpNugy,2023-07-26 08:43:31,NULL,NULL,false,10gd00000150QfGpNugy,NULL,true,0,0,NULL
